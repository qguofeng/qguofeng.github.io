---
layout: post
title: "Django系列8——ORM操作"
date: 2017-02-27  10:20:00
categories: ['Python','Web','Django']
---
```bash
友情提示:
该文章由作者QGUOFENG(http://qiuguofeng.com/)所写
欢迎指出错误一起学习
欢迎大家转载，借鉴，如果标明出处不胜感激
```
ORM的全称是Object Relational Mapping ,即对象关系映射。他的实现思想就是将关系数据库中表的数据映射成对象，以对象的形式展现，这样开发人员就可以把对数据库的操作转化为对这些对象的操作。因此它的目的是为了方便开发人员以面向对象的思想来实现对数据的操作
<br />
ROM常用的操作和数据库的操作一致都是增删改查，只是书写的格式不同。<br />
先进入shell编辑
```bash
(test1) QGUOFENG 12:55 My_first_blog\$ python manage.py shell
```
一、增加数据（两种方式）
方式一：create
方式二:save
<br />
例如：增加一个作者叫做QGUOFENG的记录(create)
```bash
>>> Author.objects.get(name="QGUOFENG")
```
例如：增加一个作者叫做张三(save)
```bash
>>> author = Author()
>>> author.name = "张三"
>>> author.save()

```
增加一条出版社的记录
```bash
>>> pub = Publisher()
>>> pub.name = "ABC出版社"
>>> pub.address = "某城"
>>> pub.city = "某市"
>>> pub.country = "某国"
>>> pub.save()
```
增加一本由ABC出版的张三写的书--张三的书
```bash
>>> book = Book()
>>> book.title = "张三的书"
>>> book.publisher=pub	#将上面新建的出版社直接赋值给book
>>> book.publication_date='2017-02-27'
>>> book.save()
#由于书本和作者是多对多的关系，会生成两张表，所以需要分两次存数据
>>> book = Book.objects.get(id=1)
>>> author = Author.objects.get(name="QGUOFENG")
>>> book.authors.add(author)
```
二、查询数据
查询采用的是惰性机制，例如Publisher.objects.all()只是返回一个QuerySet(查询结果集对象,并不会马上执行sql语句，而是当调用QuerySet的时候才执行<br />
例如：查询所有作者信息
```bash
>>> Author.objects.all()
```
例如：查询id=1的作者的信息
```bash
>>> Author.objects.get(name="QGUOFENG")
```
三、修改数据
两种方法（update,save)<br />
例如：修改id号为1的作者的名字为ABCD(save)
```bash
>>> author = Author.objects.get(id=1)
>>> author.name = "ABCD"
>>> author.save()
```
例如：修改ABC出版社的城市为A市，国家为A国
```bash
>>> Publisher.objects.filter(name="ABC出版社").update(city="A市",country="A国")
```
四、删除数据
一种方式delete<br />
删除数据需要注意，django中的删除默认是级联删除的

例如:删除张三写的书籍
```bash
>>> Book.objects.filter(authors__name="张三").delete()
```
详细的增删改查：<a href="https://docs.djangoproject.com/en/1.9/ref/models/querysets/">https://docs.djangoproject.com/en/1.9/ref/models/querysets/</a>
<br />

<a href="https://docs.djangoproject.com/en/1.9/ref/models/querysets/">https://docs.djangoproject.com/en/1.9/ref/models/querysets/</a>
<br />
