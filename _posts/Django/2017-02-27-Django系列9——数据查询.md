---
layout: post
title: "Django系列9——数据查询"
date: 2017-02-27  10:20:00
categories: ['Python','Web','Django']
---
```bash
友情提示:
该文章由作者QGUOFENG(http://qiuguofeng.com/)所写
欢迎指出错误一起学习
欢迎大家转载，借鉴，如果标明出处不胜感激
```

在django中有两种查询对象的方法:models和QuerySet对象的方法<br />
其中save和create 是model对象的方法<br />
update和delete是QuerySet对象的方法<br />
QuerySet对象的特点:可迭代的，可切片的(与python中的迭代与切片一致)
QuerySet对象的一些常用方法:
```bash
1、get(**kwargs):返回与所给的筛选条件相匹配的对象，返回结果有且只有一个，如果符合筛选条件的对象超过一个，就会抛出
MultipleObjectsReturned异常，如果没有找到符合筛选条件的对象，就会抛出DoesNotExist异常
2、all()：查询所有结果
3、filter(**kwargs):它包含了与所给的筛选条件相匹配的对象
4、exclude(**kwargs):它包含那些与所给筛选条件不匹配的对象
5、order_by(*fields):对查询结果排序
6、reverse()：对查询结果反向排序
7、distinct():从返回结果中剔除重复记录
8、values(*fields):返回一个ValuesQuerySet---一个特殊的QuerySet,运行后得到的并不>是一系列model的实例化对象，而是一个可迭代>的字典序列
9、values_list(*fields):它与values()非常相似，只不过后者返回的结果是字典序列，而
values_list()返回的结果是元组序列
10、count()：返回数据库中匹配查询(QuerySet)的对象数量
11、first():返回第一条记录，等价于[:1][0]
12、last():返回最后一条记录,等价与[::-1][0]
13、exists():如果QuerySet包含右数据，就返回True否则就返回False
```
详细的使用方法:
<a href="https://docs.djangoproject.com/en/1.9/ref/models/querysets/">https://docs.djangoproject.com/en/1.9/ref/models/querysets/</a>
<br />

<br />
单表查询:<br />
实例：查询id=1的数据信息，并且只显示书籍名称和出版日期
```bash
>>> Book.objects.filter(id=1).values('title','publication_date')
<QuerySet [{'title': '张三的书', 'publication_date': datetime.date(2017, 2, 27)}]>
```
实例：查询所有出版社信息，并按id降序排列
```bash
>>> Publisher.objects.all().order_by('-id')
```
多表查询<br />
多表查询技巧：
"_ _"两个连续的下划线可以生成链接查询，查询关联的字段信息
<br />
_ set:提供了对象访问相关表数据的方法,但是这种方法只能是相关类访问定义了关系的类(>主键类访问外键类
实例：查询张三写了那些书
```bash
>>> Book.objects.filter(authors__name="张三").values('title')
```
实例：查询ABC出版社出版了那些书籍
```bash
>>> Book.objects.filter(publisher__name="ABC出版社").values('title')
<QuerySet [{'title': '张三的书'}]>
```

